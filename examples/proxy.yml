# Locals are used to store variables that can be reused in the configuration.
locals:
  name: 'proxy-{{ BlueGreen }}'
  port: '{{ AB "8081" "8082" }}'

# Example of zero-downtime deployment with proxying traffic between two containers.
workdir: examples/proxy
cmd: ['sh', './start.sh', '{{ Local "port" }}']
env:
- 'CONTAINER_NAME={{ Local "name" }}'

# Enable proxy.
proxy:
- listen_address: '127.0.0.1:8080'
  forward_address: 'localhost:{{ Local "port" }}'
pidfile: /tmp/proxy.pid

# See healthcheck_docker.yml for more details.
healthcheck:
  docker:
    container: '{{ Local "name" }}'
